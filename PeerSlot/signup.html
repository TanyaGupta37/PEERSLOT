<!DOCTYPE html>
<html>
<head>
  <title>Sign Up - PeerSlot</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="auth-page">
  <div class="auth-left">
    <h1>PeerSlot</h1>
  </div>

  <div class="auth-right">
    <div class="auth-box">
      <h2>Sign Up</h2>

      <div class="field">
        <label>Email (MUJ)</label>
        <input id="email" placeholder="name.regno@muj.manipal.edu">
      </div>

      <div class="field">
        <label>Password</label>
        <input id="password" type="password">
      </div>

      <button onclick="signup()">Create Account</button>

      <p>Already have an account? <a href="login.html">Login</a></p>
    </div>
  </div>
</div>

<script type="module">
import { auth } from "./firebase.js";
import { createUserWithEmailAndPassword, sendEmailVerification }
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

window.signup = async () => {
  const emailVal = email.value.trim();
  const pass = password.value;

  const mujRegex = /^[a-zA-Z0-9._]+@muj\.manipal\.edu$/i;
  if (!mujRegex.test(emailVal)) {
    alert("Only MUJ Outlook IDs allowed");
    return;
  }

  const userCred = await createUserWithEmailAndPassword(auth, emailVal, pass);
  await sendEmailVerification(userCred.user);

  alert("Verification email sent. Verify and then login.");
  location.href = "login.html";
};
</script>

</body>
</html>
